### Issues & Suggested Tasks **Issue 1** Public registration is available through `/api/auth/register` and the `/register` page. Requirements state that only authorized users may create accounts, and the registration page should not appear to normal visitors. :::task-stub{title="Restrict registration to authenticated users and remove public register page"} 1. Update `server/routes/auth.js` so that the `POST /register` route uses `auth.check` middleware. - File: `server/routes/auth.js` lines 7‑13​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=15 path=server/routes/auth.js git_url="https://github.com/salah-almalawi/InspectionToursSystem/blob/main/server/routes/auth.js#L1-L15"}​2. Ensure `authController.register` keeps existing behavior once authorized. 3. Remove or protect the page at `frontend/src/app/(auth)/register/page.js`. 4. Delete the “Register” link in `frontend/src/components/Navbar.jsx` lines 8‑12​:codex-file-citation[codex-file-citation]{line_range_start=8 line_range_end=12 path=frontend/src/components/Navbar.jsx git_url="https://github.com/salah-almalawi/InspectionToursSystem/blob/main/frontend/src/components/Navbar.jsx#L8-L12"}​. ::: **Issue 2** Navigation is static and lacks a logout option. After login, only “Logout”, “Manage Managers”, and “Manage Rounds” should appear. :::task-stub{title="Make Navbar reactive with logout"} 1. Use authentication state from `authSlice` to conditionally render menu items in `frontend/src/components/Navbar.jsx`. 2. Add a “Logout” button that dispatches `logout` from `authSlice` and calls `/api/auth/logout`. 3. Display “Managers” and “Rounds” links only when a token exists; hide “Login” when authenticated. 4. Update layout (`frontend/src/app/layout.js`) if needed to pass logout handler. ::: **Issue 3** Managers page lacks creation and deletion capabilities, and details do not show the last rounds. :::task-stub{title="Implement full manager management"} 1. On `frontend/src/app/managers/page.js`, change the list to a table (name, rank, department) and add a “Create Manager” button linking to `/managers/new`. 2. Create `frontend/src/app/managers/new/page.js` with a form (name, rank, department) using `useCreateManagerMutation`. 3. Extend `frontend/src/app/managers/[id]/page.js`: - Show manager info and populate `lastRounds`. - Add “Delete” button using `useDeleteManagerMutation`. - Provide editable fields for update. ::: **Issue 4** Inspection rounds page should display a table with full round details and allow creating rounds through a dedicated form. :::task-stub{title="Improve inspection rounds management UI"} 1. Modify `frontend/src/app/rounds/page.js` to render rounds in a table with columns: date, manager name, day, time, location. 2. Provide a “New Round” button to open an inline or separate form. 3. Use manager dropdown (already retrieved via `useGetManagersQuery`) and submit with `useCreateRoundMutation`. ::: **Issue 5** Home page needs a “تقرير ما قبل الجولة” button that fetches a manager summary (`/api/managers/{id}/summary`). :::task-stub{title="Add pre‑round report functionality"} 1. Add a button to `frontend/src/app/page.js` beneath the welcome text. 2. Clicking the button lists managers; when a manager is chosen, use `useGetManagerSummaryQuery` (already exposed in `services/api.js` lines 31‑39​:codex-file-citation[codex-file-citation]{line_range_start=31 line_range_end=39 path=frontend/src/services/api.js git_url="https://github.com/salah-almalawi/InspectionToursSystem/blob/main/frontend/src/services/api.js#L31-L39"}​). 3. Display manager info and rounds from the returned summary. 4. Consider placing this feature in a new page or modal. ::: **Issue 6** To enforce the login‑first flow, accessing the site without a token should always show the login page. :::task-stub{title="Ensure root redirects to login when unauthenticated"} 1. Adjust `frontend/src/app/page.js` so that, if no token exists, it immediately redirects to `/login` rather than rendering home content. 2. Verify `useRequireAuth` is consistent across other protected pages. ::: ### Testing - Run `npm test` inside `server` to ensure API tests still pass. - Start both `server` and `frontend` in development mode and verify the new navigation flow, creation/deletion of managers and rounds, and the pre‑round report. Codex couldn't run certain commands due to environment limitations. Consider configuring a setup script or internet access in your Codex environment to install dependencies.